# Mars 25.01.2015 14:30 (Run2, Mars Express inbound)

# Jarvinen et al., Energization of Oxygen Ions at Mars: Comparison of
# a Global Hybrid Model to In Situ Observations, AGU Fall Meeting
# 2015, P21A-2092

gridbuilder = LogicallyCartesian

[Restart]
filename = 

[Simulation]
time_initial = 0.0
maximum_timesteps = 80000
dt = 0.0075
data_save_interval = 5000
data_save_interval_unit = timestep
data_save_initial_state = yes
maximum_load_imbalance = 1.2
repartition_check_interval = 1500
random_number_generator.seed = 6461674
restart_write_interval = 0
restart_major_store_interval = 0
restart_minor_store_amount = 0
#restart = yes
save_particles = 0
mesh_always_written = yes

[LoadBalance]
methods = RCB
#methods = RANDOM
tolerances = 1.05
processes_per_partition = 2

[LogicallyCartesian]
geometry = cartesian
x_periodic = no
y_periodic = no
z_periodic = no
x_min = -13558000
y_min = -13558000
z_min = -13558000
x_max = +13558000
y_max = +13558000
z_max = +13558000
dx_uniform = yes
dy_uniform = yes
dz_uniform = yes
x_size = 240
y_size = 240
z_size = 240
x_label = x-axis
y_label = y-axis
z_label = z-axis
x_units = m
y_units = m
z_units = m
force_cubic_cells = no

[DataOperatorExcludes]
exclude_list =

[Hybrid]
log_interval = 500
log_precision = 10
includeInnerCellsInFieldLog = 0
main_log_diagnostics_interval = 1000
output_parameters = cellBAverage cellUe n_ave v_ave
save_reduced_state_interval = 0
save_reduced_state_Nstride = 10
save_reduced_state_include_particles = 0
save_particles = 0
save_particles_Nstride = 10
R_object = 3390e3
R_fieldObstacle = 3690e3
fieldObstacleUe = (0,0,0)
R_particleObstacle = 3590e3
R_cellEpObstacle = -100
gravity = 0
M_object = 0.64169e24
initialFlowThroughPeriodFactor = -1
maxUe = 5000e3
maxVi = 5000e3
minRhoQi = 1.6020e-14
terminateLimitMaxB = 1000e-9
maxE = -100
maxVw = -100
hall_term = 1
include_B0_faraday = 0
electron_pressure = 0
Te = 1e4
Efilter = 1
EfilterNodeGaussSigma = 0
particle.population.solarwind = swH+
particle.population.solarwind = swHe++
particle.population.ionosphere = ionoO+
particle.population.ionosphere = ionoO2+
particle.population.exosphere = exoH+
particle.population.exosphere = exoO+

[Resistivity]
profile_name = resistivitySuperConductingSphere
value_unit = grid
value = 0.02
R = 3690e3

[OuterBoundaryZone]
etaBoundarySizes = 0 0 0 0 0 0
etaBoundaryCoeffs = 1 1 1 1 1 1
typeMinRhoQi = 0
sizeMinRhoQi = 0
minRhoQi = 0
constUe = 0

[IMF]
Bx = 4.2657e-9
By = 4.0026e-9
Bz = 3.2995e-9
BoundaryCellB = 1 0 0 0 0 0
BoundaryFaceB = 1 0 0 0 0 0

[IntrinsicB]
profile_name = laminarFlowAroundSphereBx
laminarR = 3690e3
coeffDipole = 0
coeffQuadrupole = 0
dipoleSurfaceB = 0
dipoleSurfaceR = 1000e3
minimumR = 1000e3
x = 0
y = 0
z = 0
theta = 0
phi = 0

[BackgroundChargeDensity]
profile_name = none
R = -1
r0 = -1
n0 = -1

[swH+]
mass_unit = MASS_PROTON
charge_unit = CHARGE_ELEMENTARY
mass = 1.0
charge = +1.0
obstacle = 3590e3
accumulate = 1
accelerate = 1
output_str = H+sw
output_plasma = 1
injector.name = SolarWindInjector
injector.parameters = injector_swH+
accumulator.name = HybridAccumulator
accumulator.parameters =
boundary_condition.name = HybridBoundaryCond
boundary_condition.parameters =
propagator.name = BorisBuneman
propagator.parameters =

[injector_swH+]
velocity = (-300e3,0,0)
density = 20e6
temperature = 6e4
macroparticles_per_cell = 50

[swHe++]
mass_unit = MASS_PROTON
charge_unit = CHARGE_ELEMENTARY
mass = 3.9737
charge = +2.0
obstacle = 3590e3
accumulate = 1
accelerate = 1
output_str = He++sw
output_plasma = 1
injector.name = SolarWindInjector
injector.parameters = injector_swHe++
accumulator.name = HybridAccumulator
accumulator.parameters =
boundary_condition.name = HybridBoundaryCond
boundary_condition.parameters =
propagator.name = BorisBuneman
propagator.parameters =

[injector_swHe++]
velocity = (-300e3,0,0)
density = 1e6
temperature = 6e4
macroparticles_per_cell = 10

[ionoO+]
mass_unit = MASS_PROTON
charge_unit = CHARGE_ELEMENTARY
mass = 15.883821896403
charge = +1.0
obstacle = 3590e3
accumulate = 1
accelerate = 1
output_str = O+
output_plasma = 1
injector.name = IonosphereInjector
injector.parameters = injector_ionoO+
accumulator.name = HybridAccumulator
accumulator.parameters =
boundary_condition.name = HybridBoundaryCond
boundary_condition.parameters =
propagator.name = BorisBuneman
propagator.parameters =

[injector_ionoO+]
profile_name = ionoCosSzaDayConstantNight
emission_radius = 3790e3
noon = 1.0
night = 0.1
temperature = 6000
total_production_rate = 1.4e25
macroparticles_per_cell = 5.0

[ionoO2+]
mass_unit = MASS_PROTON
charge_unit = CHARGE_ELEMENTARY
mass = 31.7676437922082
charge = +1.0
obstacle = 3590e3
accumulate = 1
accelerate = 1
output_str = O2+
output_plasma = 1
injector.name = IonosphereInjector
injector.parameters = injector_ionoO2+
accumulator.name = HybridAccumulator
accumulator.parameters =
boundary_condition.name = HybridBoundaryCond
boundary_condition.parameters =
propagator.name = BorisBuneman
propagator.parameters =

[injector_ionoO2+]
profile_name = ionoCosSzaDayConstantNight
emission_radius = 3790e3
noon = 1.0
night = 0.1
temperature = 6000
total_production_rate = 2e25
macroparticles_per_cell = 5.0

[exoH+]
mass_unit = MASS_PROTON
charge_unit = CHARGE_ELEMENTARY
mass = 1.0
charge = +1.0
obstacle = 3590e3
accumulate = 1
accelerate = 1
output_str = H+planet
output_plasma = 1
injector.name = ExosphereInjector
injector.parameters = injector_exoH+
accumulator.name = HybridAccumulator
accumulator.parameters =
boundary_condition.name = HybridBoundaryCond
boundary_condition.parameters =
propagator.name = BorisBuneman
propagator.parameters =

[injector_exoH+]
neutral_profile = ChamberlainH
neutral_profile.r0 = 3593.5e3
neutral_profile.n0 = 1.5e11
neutral_profile.n0 = 1.9e10
neutral_profile.H0 = 25965e3
neutral_profile.H0 = 10365e3
temperature = 6500
exobase_radius = 3790e3
shadow_radius = 3390e3
total_production_rate = 5.47e24
macroparticles_per_cell = 5.0

[exoO+]
mass_unit = MASS_PROTON
charge_unit = CHARGE_ELEMENTARY
mass = 15.883821896403
charge = +1.0
obstacle = 3590e3
accumulate = 1
accelerate = 1
output_str = O+
output_plasma = 1
injector.name = ExosphereInjector
injector.parameters = injector_exoO+
accumulator.name = HybridAccumulator
accumulator.parameters =
boundary_condition.name = HybridBoundaryCond
boundary_condition.parameters =
propagator.name = BorisBuneman
propagator.parameters =

[injector_exoO+]
neutral_profile = Exponential
neutral_profile.r0 = 3393.5e3
neutral_profile.n0 = 5.23e9
neutral_profile.n0 = 9.76e8
neutral_profile.n0 = 3.71e10
neutral_profile.H0 = 626.2e3
neutral_profile.H0 = 2790e3
neutral_profile.H0 = 88.47e3
temperature = 6500
exobase_radius = 3790e3
shadow_radius = 3390e3
total_production_rate = 0.156e24
macroparticles_per_cell = 5.0


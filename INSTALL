EXAMPLE COMPILATION

Ubuntu 22.04.5 LTS (Apr 2, 2025)

# download source codes
mkdir ~/bin/
cd ~/bin/
git clone https://github.com/fmihpc/analysator
git clone https://github.com/fmihpc/rhybrid
git clone https://github.com/fmihpc/corsair
git clone https://github.com/fmihpc/vlsv
git clone https://github.com/fmihpc/pargrid
wget https://github.com/sandialabs/Zoltan/archive/refs/tags/v3.901.tar.gz
mv v3.901.tar.gz Zoltan-v3.901.tar.gz
tar -xzf Zoltan-v3.901.tar.gz -C ./

# compile Zoltan
cd Zoltan-3.901/
mkdir build
cd build
../configure --prefix=$HOME/bin/Zoltan-3.901/build
make
make install

# compile VLSV
cd ~/bin/vlsv
cp -p Makefile.arch Makefile.newuser
jed Makefile.newuser
CXXFLAGS = -O3 -std=c++17 -Wall
INC_SILO=
LIB_SILO=
jed Makefile
ARCH ?= newuser
default: lib
# and other necessary options for your local system
make

# compile Corsair and RHybrid
cd ~/bin/corsair/
mkdir ~/bin/corsair/src/user/rhybrid/
cp -p ~/bin/rhybrid/src/* ~/bin/corsair/src/user/rhybrid/
cd ~/bin/corsair/
cp -p Makefile.arch Makefile.newuser
jed Makefile.newuser
SIM=rhybrid
jed Makefile
ARCH ?= newuser
SIM ?= rhybrid
# and other necessary options for your local system
make

# perform a testrun
mkdir testrun
cd testrun
OMPI_MCA_io=^ompio mpirun -n 4 ../corsair_rhybrid --runconfig=${HOME}/bin/rhybrid/examples/mars.cfg

# plot particle and field logs as PDF files
PATH=${PATH}:~/bin/rhybrid/tools/ rhb_log2pdf_all.sh lin
evince field.pdf pop*.pdf

# use Analysator to study simulation outputs
export PYTHONPATH=$PYTHONPATH:~/bin/analysator

# visualisation
python ~/bin/rhybrid/tools/plotter_example_testrun.py
eog testrun.png

# interpolate variables in selected points
python ~/bin/rhybrid/tools/interpolate_points.py
eog testrun_interpolate_points*.png

# construct time series in a point
python ~/bin/rhybrid/tools/create_time_series_point.py
cat time_series_testrun01.dat

# create a new file with derived parameters
python ~/bin/rhybrid/tools/create_derived_parameters.py
ls *derived*.vlsv

# propagate test particles in E and B fiels from testrun
python ~/bin/rhybrid/tools/trace_test_particle.py
eog testrun_trace_test_particle_*.png

